<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html" />
        <link href="eve-murmur2/css/apipagecssr2.css" rel="stylesheet" type="text/css" />
        <title>EVE Murmur API Registration</title>
        <script src="eve-murmur2/js/jquery-1.5.min.js" type="text/javascript" charset="utf-8"></script>
        <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {

                $('#userIdInput').keyup(function(){
                    if(validField('#userIdInput', /^\d{5,}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }
                });
                $('#userIdInput').mouseup(function(){
                    if(validField('#userIdInput', /^\d{5,}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }
                });
                $('#userIdInput').blur(function(){
                    if(validField('#userIdInput', /^\d{5,}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }
                });
                $('#apiInput').keyup(function(){
                    if(validField('#apiInput', /^[A-Za-z0-9]{64}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }
                });
                $('#apiInput').mouseup(function(){
                    if(validField('#apiInput', /^[A-Za-z0-9]{64}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }                });
                $('#apiInput').blur(function(){
                    if(validField('#apiInput', /^[A-Za-z0-9]{64}$/)){
                        $('#submitButton').attr('disabled', false);
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }                });
                $('#password1').keyup(function(){
                    if(validField('#password1', /^\w{5,}$/)){
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }
                });
                $('#password1').mouseup(function(){
                    if(validField('#password1', /^\w{5,}$/)){
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }                });
                $('#password1').blur(function(){
                    if(validField('#password1', /^\w{5,}$/)){
                    } else {
                        $('#submitButton').attr('disabled', true);
                    }                });
                $('#password2').keyup(function(){
                    $(this).removeClass('invalidinput validinput');
                    if($(this).val() == $('#password1').val()){
                        $('#submitButton').attr('disabled', false);
                        $(this).addClass('validinput');
                    } else {
                        $('#submitButton').attr('disabled', true);
                        $(this).addClass('invalidinput');
                    }
                });
                $('#password2').mouseup(function(){
                    $(this).removeClass('invalidinput validinput');
                    if($(this).val() == $('#password1').val()){
                        $('#submitButton').attr('disabled', false);
                        $(this).addClass('validinput');
                    } else {
                        $('#submitButton').attr('disabled', true);
                        $(this).addClass('invalidinput');
                    }
                });
                $('#password2').blur(function(){
                    $(this).removeClass('invalidinput validinput');
                    if($(this).val() == $('#password1').val()){
                        $('#submitButton').attr('disabled', false);
                        $(this).addClass('validinput');
                    } else {
                        $('#submitButton').attr('disabled', true);
                        $(this).addClass('invalidinput');
                    }
                });
                $('#inputForm').submit(function(e) {
                    e.preventDefault();
                    $.post($(this).attr("action"), $(this).serialize(), function(data) {
                        if(data.hasOwnProperty('type')){
                            if(data.type == 'success') {
                                alert("Success\n" + data.message);
                            } else {
                                alert("Error\n" + data.message);
                            }
                        }
                        if($('#password2').val().length >= 5 && $('#password1').val() == $('#password2').val()){

                        } else {
                            $('#submitButton').attr('disabled', true);
                            $('#charDiv').show('fast');
                            $('#charSel').empty();
                            $(data).each(function(i) {
                                $('#charSel').
                                    append($('<option></option>').
                                    attr('value',$(this)[0].charid).
                                    text($(this)[0].name));
                            });
                        }
                    }, "json");
                });
            });

            function validField(field, regex) {
                $(field).removeClass('invalidinput validinput');
                var match = $(field).val().match(regex);
                if(match == null){
                    $(field).addClass('invalidinput');
                    return false;
                } else {
                    $(field).addClass('validinput');
                    return true;
                }
            }

            function trimmer() {
                $('body :text').each(function() {
                    $(this).val() = $(this).val().trim();
                });
            }
        </script>
    </head>
    <body>
        <form name="input" id="inputForm" action="http://www.redskymorning.com/eve-murmur2/register/submit">
            <div id="apicontent">
                <h1>Mumble Registration</h1>
                <p>1. <a href="http://mumble.sourceforge.net" target="_blank">Download Mumble</a></p>
                <p>2. <a href="http://www.eveonline.com/api/" target="_blank">Get your limited API Key</a></p>
                <p>User ID:</p>
                <input type="text" class="userinput" name="userid" id="userIdInput">
                <p>Limited API:</p>
                <input type="text" class="userinput" name="apikey" id="apiInput">
                <div id="charDiv" style="display: none;">
                    <p>Character: </p>
                    <select class="userselect" name="charid" id="charSel">
                    </select>
                    <p>Password:</p>
                    <input type="password" class="userinput" name="password" id="password1">
                    <p>Confim Password:</p>
                    <input type="password" class="userinput" name="password2" id="password2">
                </div>
                <button name="save" type="submit" class="positive" id="submitButton"><img src="http://www.redskymorning.com/eve-murmur2/images/apply2.png" alt=""/>Submit</button>
            </div>
        </form>
    </body>
</html>